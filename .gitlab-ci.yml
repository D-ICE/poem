include:
  - project: 'common/ci-utils'
    file:
      - '/templates/.add-ssh-key.yml'
      - '/templates/.add-aws-key.yml'
  - 'ci-utils/.libpoem.yml'
  - 'ci-utils/.pypoem.yml'

stages:
  - build
  - deploy

#cpp-linux-tests:
#  extends:
#    - .libpoem-linux
#    - .libpoem-tests

#pypoem-linux-tests:
#  extends: 
#    - .pypoem-linux
#    - .pypoem-tests
#  variables:
#    CIBW_BUILD: cp312-manylinux_x86_64

#pypoem-linux-multiversion:
#  extends:
#    - .pypoem-linux
#    - .pypoem-multiversion
#  variables:
#    CIBW_BUILD: cp3*-manylinux_x86_64

#pypi-deploy:
#  only:
#    - tags
#  stage: deploy
#  image: python:3.12-bullseye
#  variables:
#    TWINE_USERNAME: $TWINE_USERNAME
#    TWINE_PASSWORD: $TWINE_PASSWORD
#  before_script:
#    - pip install twine
#    - ls linuxwheels
#  script:
    # TODO: trouver un moyen de recuperer les versions de pipy
#    - twine upload linuxwheels/*

essai-user:
  script:
    - runas /user:dice /savecred echo "coucou"
  tags:
    windows-test

#cpp-windows-tests:
#  extends:
#    - .libpoem-windows
#    - .libpoem-tests

#pypoem-windows-tests:
#  extends:
#    - .pypoem-windows 
#    - .pypoem-tests
#  variables:
#    CIBW_BUILD: cp313-win_amd64

#pypoem-windows-multiversion:
#  extends:
#    - .pypoem-windows 
#    - .pypoem-multiversion
#  variables:
#    CIBW_BUILD: cp3*-win_amd64

#pypi-windows-deploy:
#  only:
#    - tags
#  stage: deploy
#  variables:
#    TWINE_USERNAME: $TWINE_USERNAME
#    TWINE_PASSWORD: $TWINE_PASSWORD
#  script:
#    # TODO: trouver un moyen de recuperer les versions de pipy
#    - twine upload wheels/*
#  tags:
#    - windows
